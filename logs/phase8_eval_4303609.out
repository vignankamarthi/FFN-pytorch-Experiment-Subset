============================================================
Phase 8: Unified TFD Evaluation
============================================================

--- Evaluating Vanilla TSM at 4F, 8F, 16F ---

============================================================
DETECTED: CUDA (NVIDIA GPU)
  GPU: NVIDIA H200
  Available GPUs: 1
============================================================
============================================================
TFD Evaluation
============================================================
  Model type:  tsm
  Checkpoint:  checkpoints/vanilla_tsm/best.pth
  Device:      cuda
  Batch size:  32
  Test run:    False
============================================================
  Checkpoint epoch: 21
  Checkpoint best_acc: 56.689671872184356

  Evaluating at 4F...
    Acc@1: 30.13%  |  Acc@5: 57.82%

  Evaluating at 8F...
    Acc@1: 48.93%  |  Acc@5: 77.92%

  Evaluating at 16F...
    Acc@1: 56.68%  |  Acc@5: 84.22%

============================================================
  Vanilla TSM (TFD Collapse)
============================================================
  Frames          Acc@1      Acc@5
  ------------------------------
  4F             30.13%     57.82%
  8F             48.93%     77.92%
  16F            56.68%     84.22%
  ------------------------------
  TFD Gap (16F - 4F): 26.55 points
============================================================


--- Evaluating FFN at 4F, 8F, 16F ---

============================================================
DETECTED: CUDA (NVIDIA GPU)
  GPU: NVIDIA H200
  Available GPUs: 1
============================================================
============================================================
TFD Evaluation
============================================================
  Model type:  ffn
  Checkpoint:  checkpoints/ffn/best.pth
  Device:      cuda
  Batch size:  32
  Test run:    False
============================================================
  Checkpoint epoch: 20
  Checkpoint best_acc: 58.86911248242773

  Evaluating at 4F...
    Acc@1: 50.86%  |  Acc@5: 79.30%

  Evaluating at 8F...
    Acc@1: 56.52%  |  Acc@5: 83.94%

  Evaluating at 16F...
    Acc@1: 58.85%  |  Acc@5: 85.97%

============================================================
  FFN (TFD Recovery)
============================================================
  Frames          Acc@1      Acc@5
  ------------------------------
  4F             50.86%     79.30%
  8F             56.52%     83.94%
  16F            58.85%     85.97%
  ------------------------------
  TFD Gap (16F - 4F): 8.00 points
============================================================

============================================================
Phase 8 evaluation complete.
============================================================
